{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="main-container">
    <!-- Header Section -->
    <div class="header">
        <h1>Dashboard</h1>
        <p>Welcome, {{ user.username }}!</p>
    </div>

    <!-- Portfolio Section -->
    <h2>Your Portfolios</h2>
    {% if portfolios %}
        <ul>
            {% for portfolio in portfolios %}
                <li>
                    <a href="{% url 'portfolio_details' portfolio.id %}">
                        {{ portfolio.name }} - Balance: £{{ portfolio.balance }} - Total Value: £{{ portfolio.total_value }}
                    </a>
                    <form action="{% url 'delete_portfolio' portfolio.id %}" method="post" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit">Delete</button>
                    </form>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p>You have no portfolios yet.</p>
    {% endif %}
    <a href="{% url 'create_portfolio' %}">Create New Portfolio</a>

    <!-- Charts Section -->
    <div class="chart-container">
        <div class="sales-chart">
            <h4>Sales Performance</h4>
            <p>Chart Placeholder</p>
        </div>
        <div class="stocks-chart">
            <h4>Your Stocks</h4>
            <p>Pie Chart Placeholder</p>
        </div>
    </div>

    <!-- Recent Trades Section -->
    <div class="table-container">
        <h4>Recent Trades</h4>
        <table>
            <thead>
                <tr>
                    <th>Stock</th>
                    <th>Order Date</th>
                    <th>Amount (£)</th>
                    <th>Stock Market</th>
                    <th>P/E Ratio</th>
                </tr>
            </thead>
            <tbody>
                {% for trade in recent_trades %}
                <tr>
                    <td>{{ trade.symbol }}</td>
                    <td>{{ trade.timestamp|date:"Y-m-d" }}</td>
                    <td>£{{ trade.trade_price }}</td>
                    <td>{{ trade.market|default:"N/A" }}</td>
                    <td>{{ trade.pe_ratio|default:"N/A" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">No recent trades available.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
